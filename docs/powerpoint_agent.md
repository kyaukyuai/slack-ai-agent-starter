# PowerPointエージェント

PowerPointエージェントは、ユーザーの要件に基づいて自動的にPowerPointプレゼンテーションを生成するAIエージェントです。

## 機能

- ユーザーの入力から要件を抽出し、構造化
- 要件に基づいてプレゼンテーションのアウトラインを生成
- アウトラインに基づいて各スライドの詳細なコンテンツを生成
- 生成したコンテンツをPowerPointファイルとして出力

## 前提条件

PowerPointエージェントを使用するには、以下のライブラリが必要です：

```bash
pip install python-pptx
```

## 使用方法

### 1. 要件の定義

PowerPointプレゼンテーションの要件を以下の形式で定義します：

```
# パワーポイント作成要件

## タイトル
[プレゼンテーションのタイトル]

## 目的
[プレゼンテーションの目的]

## 対象者
[想定される閲覧者/聴衆]

## 主要なトピック
- [トピック1]
- [トピック2]
- ...

## スタイルと形式
- [フォーマルさのレベル]
- [希望するデザインスタイル]
- [その他の形式に関する要件]

## 特別な要望
[その他の重要な情報や要件]
```

### 2. エージェントの実行

PowerPointエージェントは以下のように実行します：

```python
from slack_ai_agent.agents.powerpoint_agent import run_powerpoint_agent

# 会話履歴を定義
messages = [
    {
        "role": "user",
        "content": """
# パワーポイント作成要件

## タイトル
Pythonプログラミング入門

## 目的
プログラミング初心者にPythonの基本を紹介する

## 対象者
プログラミング未経験者、Python初心者

## 主要なトピック
- Pythonとは何か
- Pythonのインストール方法
- 基本的な文法（変数、条件分岐、ループ）
- 関数の定義と使用方法
- モジュールとパッケージ
- 実践的な例（簡単なプログラム作成）

## スタイルと形式
- シンプルで読みやすいデザイン
- コード例を含める
- 図や表を使って視覚的に説明

## 特別な要望
- 各トピックの最後に練習問題を入れる
- 参考資料やリソースのリストを最後に追加
        """
    },
    {
        "role": "assistant",
        "content": "要件を確認しました。この内容でPowerPointを作成してよろしいですか？"
    },
    {
        "role": "user",
        "content": "はい、この要件で作成してください。"
    }
]

# エージェントを実行
result = run_powerpoint_agent(messages)

# 結果を表示
print(f"PowerPointファイルが作成されました: {result.get('powerpoint_path')}")
```

### 3. 生成されたPowerPointファイル

エージェントは、要件に基づいてPowerPointファイルを生成し、ファイルパスを返します。生成されたファイルは、Microsoft PowerPointまたは互換性のあるアプリケーションで開くことができます。

## サポートされているスライドタイプ

PowerPointエージェントは、以下のスライドタイプをサポートしています：

- **text**: テキストのみのスライド。複数のセクションと箇条書きで構成。
- **image**: テキストと画像を含むスライド。
- **table**: 表とキーメッセージを含むスライド。
- **two_column**: 2カラムで対比を示すスライド。
- **three_images**: 3つの画像とそれぞれのキーメッセージを含むスライド。
- **three_horizontal_flow**: 3つの要素を横向きのフローで表すスライド。
- **three_vertical_flow**: 3つの要素を縦向きのフローで表すスライド。

## 制限事項

- 現在のバージョンでは、画像は事前に定義されたプレースホルダーのみを使用します。
- 複雑なアニメーションやトランジションはサポートされていません。
- 生成されるスライドの数は、要件の複雑さに依存します。

## トラブルシューティング

### PowerPointファイルが生成されない

- `python-pptx`ライブラリがインストールされていることを確認してください。
- 要件が十分に詳細であることを確認してください。
- エラーメッセージを確認し、必要に応じて要件を修正してください。

### 生成されたPowerPointの内容が期待と異なる

- 要件をより具体的に記述してください。
- 特に重要なポイントは「特別な要望」セクションに記載してください。
- 複数回試行して、最適な結果を得てください。

## 詳細設計

PowerPointエージェントの詳細設計については、[設計ドキュメント](./design/powerpoint_agent_design.md)を参照してください。
