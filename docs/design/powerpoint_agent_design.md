# PowerPointエージェント設計書

## 要件定義書

### 概要
PowerPointエージェントは、ユーザーの要件に基づいて自動的にPowerPointプレゼンテーションを生成するAIエージェントです。このエージェントは、要件の定義から最終的なPowerPointファイルの生成までの一連のプロセスを自動化します。

### 目的
- ユーザーの入力から要件を抽出し、構造化する
- 要件に基づいてプレゼンテーションのアウトラインを生成する
- アウトラインに基づいて各スライドの詳細なコンテンツを生成する
- 生成したコンテンツをPowerPointファイルとして出力する

### ユーザー要件
1. ユーザーはチャットインターフェースを通じて要件を入力できる
2. システムは要件を解析し、構造化された形式で表示する
3. ユーザーは要件を確認し、必要に応じて修正できる
4. システムは要件に基づいてPowerPointプレゼンテーションを生成する
5. 生成されたPowerPointファイルはユーザーが編集可能である

## 設計書

### 概略設計

PowerPointエージェントは以下の主要コンポーネントで構成されます：

1. **要件定義エージェント**：ユーザーの入力から要件を抽出し、構造化します
2. **PowerPoint生成エージェント**：要件に基づいてPowerPointプレゼンテーションを生成します
   - **アウトライン生成**：プレゼンテーションの構造を決定します
   - **スライドコンテンツ生成**：各スライドの詳細なコンテンツを生成します
   - **PowerPoint作成**：生成したコンテンツをPowerPointファイルに変換します

### 機能設計

#### 要件定義エージェント
- ユーザーの入力からタイトル、目的、対象者、トピック、スタイル、特別な要望などの要件を抽出
- 抽出した要件を構造化された形式で表示
- ユーザーからのフィードバックに基づいて要件を更新
- 要件の妥当性を検証

#### PowerPoint生成エージェント
- **アウトライン生成**
  - 要件に基づいてプレゼンテーションの構造を決定
  - 各スライドのタイトル、内容の概要、テンプレートタイプを指定

- **スライドコンテンツ生成**
  - 各スライドの詳細なコンテンツを生成
  - スライドのタイプに応じて適切なコンテンツ形式を選択（テキスト、画像、表、2カラム、フローなど）

- **PowerPoint作成**
  - 生成したコンテンツをPowerPointファイルに変換
  - スライドのレイアウトやデザインを適用

### クラス構成

#### 状態クラス
- `RequirementsState`: 要件定義ワークフローの状態を管理
- `PowerPointGenerationState`: PowerPoint生成ワークフローの状態を管理
- `PowerPointAgentState`: 全体のワークフローの状態を管理

#### エージェントクラス
- `create_requirements_definition_workflow()`: 要件定義ワークフローを作成
- `create_powerpoint_generation_workflow()`: PowerPoint生成ワークフローを作成
- `create_powerpoint_agent()`: 全体のワークフローを作成

#### ツールクラス
- `create_requirements_definition_tool`: 要件定義ツール
- `create_powerpoint_tool`: PowerPoint生成ツール

### ワークフロー

1. **要件定義フェーズ**
   - ユーザーの入力から要件を抽出
   - 要件を構造化して表示
   - ユーザーからのフィードバックを受け取り、要件を更新
   - 要件の妥当性を検証

2. **PowerPoint生成フェーズ**
   - **アウトライン生成**
     - 要件に基づいてプレゼンテーションの構造を決定
     - 各スライドのタイトル、内容の概要、テンプレートタイプを指定

   - **スライドコンテンツ生成**
     - 各スライドの詳細なコンテンツを生成
     - スライドのタイプに応じて適切なコンテンツ形式を選択

   - **PowerPoint作成**
     - 生成したコンテンツをPowerPointファイルに変換
     - スライドのレイアウトやデザインを適用

3. **結果の返却**
   - 生成されたPowerPointファイルのパスを返却

## 技術的詳細

### 使用ライブラリ
- `python-pptx`: PowerPointファイルの生成
- `langgraph`: エージェントワークフローの構築
- `langchain`: LLMとのインタラクション

### データフロー
1. ユーザー入力 → 要件定義エージェント → 構造化された要件
2. 構造化された要件 → PowerPoint生成エージェント → PowerPointファイル
3. PowerPointファイル → ユーザー

### エラーハンドリング
- 要件の不足や矛盾がある場合は、ユーザーにフィードバックを提供
- PowerPoint生成中にエラーが発生した場合は、フォールバックメカニズムを使用して最低限の出力を保証

## 将来の拡張性

### 短期的な拡張
- より多様なスライドテンプレートのサポート
- 画像生成機能の統合
- デザインテーマのカスタマイズオプション

### 長期的な拡張
- ユーザーのフィードバックに基づく継続的な改善
- 複数のプレゼンテーションスタイルのサポート
- 外部データソースとの統合
